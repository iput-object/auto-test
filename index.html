<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Hyper CN ROM Builder</title>
  <style>
    body { font-family: Arial; margin: 40px; }
    input, button { padding: 10px; margin: 5px; width: 300px; }
    button { cursor: pointer; }
  </style>
</head>
<body>
  <h1>Hyper CN ROM Builder</h1>
  <input id="ota_link" placeholder="Enter OTA Link"><br>
  <input id="pixeldrain_key" placeholder="Enter Pixeldrain API Key"><br>
  <input id="telegram_username" placeholder="Enter Telegram Username"><br>
  <button onclick="runBuild()">Run Build</button>

  <script>
    async function runBuild() {
      const ota = document.getElementById("ota_link").value;
      const pix = document.getElementById("pixeldrain_key").value;
      const tele = document.getElementById("telegram_username").value;

      // This requires a fine-grained PAT in GitHub Secrets, not here in HTML
      const token = "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"; // REMOVE later, only for local testing

      const res = await fetch("https://api.github.com/repos/iput-object/auto-test/dispatches", {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${token}`, // This will be replaced by backend workflow
          "Accept": "application/vnd.github+json"
        },
        body: JSON.stringify({
          event_type: "trigger_build",
          client_payload: {
            ota_link: ota,
            pixeldrain_key: pix,
            telegram_username: tele
          }
        })
      });

      if (res.ok) {
        alert("Build triggered!");
      } else {
        alert("Error: " + await res.text());
      }
    }
  </script>
</body>
</html>
